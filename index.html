<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gym Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="btn-settings-icon" onclick="toggleSettings()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
    </div>

    <div id="settingsModal" class="settings-modal hidden">
        <div class="settings-header">
            <h2>Paramètres</h2>
            <button class="btn-close-settings" onclick="toggleSettings()">✖</button>
        </div>
        
        <div class="settings-section">
            <h3>Gestion des données</h3>
            <button class="btn-backup" onclick="exportData()">Sauvegarder mes données</button>
            <button class="btn-restore" onclick="triggerImport()">Importer une sauvegarde</button>
            <input type="file" id="importFile" style="display:none" onchange="importData(this)" accept=".json">
        </div>
    </div>

    <div class="container">
        <h1 id="mainTitle">Ma Séance</h1>

        <div id="view-seance" class="app-view">
            <select id="selectProgram" onchange="handleProgramChange()">
                <option value="" disabled selected>Choisir une Séance</option>
            </select>

            <div id="zoneTravail"></div>
            <div id="zoneFinSeance"></div>
        </div>

        <div id="view-progs" class="app-view hidden">
            <button class="builder-btn" onclick="toggleBuilder()">+ Créer / Modifier une Séance</button>
            
            <div id="builderArea" class="hidden">
                <input type="text" id="newProgName" placeholder="Nom de la Séance (ex: PUSH)" style="margin-bottom:15px; font-weight:900;">
                
                <div class="builder-block">
                    <span class="builder-label" id="labelExoA">Exercice A</span>
                    <input type="text" id="buildExoName" placeholder="Nom de l'exercice">
                    <div class="builder-row" style="margin-top:10px;">
                        <div class="input-wrapper"><input type="number" id="buildSeries" placeholder="Séries"><span class="unit-label">Séries</span></div>
                        <div class="input-wrapper"><input type="text" id="buildReps" placeholder="Reps"><span class="unit-label">Reps</span></div>
                    </div>

                    <div id="blockExoB" class="hidden" style="margin-top:20px; border-top:1px dashed #ccc; padding-top:15px;">
                        <span class="builder-label">Exercice B (Superset)</span>
                        <input type="text" id="buildExoNameB" placeholder="Nom de l'exercice B">
                        <div class="builder-row" style="margin-top:10px;">
                            <div class="input-wrapper"><input type="number" id="buildSeriesB" placeholder="Séries"><span class="unit-label">Séries</span></div>
                            <div class="input-wrapper"><input type="text" id="buildRepsB" placeholder="Reps"><span class="unit-label">Reps</span></div>
                        </div>
                    </div>
                </div>

                <div id="btnGroupNormal">
                    <button class="btn-add" id="btnAddNormal" onclick="ajouterExoAuBuilder()">Ajouter</button>
                    <button class="btn-add-superset" onclick="activerModeSuperset()">Transformer en Superset</button>
                </div>
                
                <div id="btnGroupSuperset" class="hidden">
                    <button class="btn-add" id="btnAddSupersetConfirm" onclick="validerSupersetBuilder()">Valider le Superset</button>
                    <button class="btn-cancel" onclick="annulerModeSuperset()">Annuler le Superset</button>
                </div>

                <div id="builderListDisplay" style="margin-top:20px;"></div>
                <button class="btn-primary" id="btnSaveProg" onclick="sauvegarderProgrammeFinal()" style="margin-top:20px;">Sauvegarder la Séance</button>
            </div>

            <div id="listeMesProgrammes"></div>
        </div>

        <div id="view-history" class="app-view hidden">
            <div class="segmented-control">
                <button class="segment-btn active" id="switchList" onclick="switchHistoryMode('list')">Liste</button>
                <button class="segment-btn" id="switchCal" onclick="switchHistoryMode('calendar')">Calendrier</button>
                <button class="segment-btn" id="switchWeight" onclick="switchHistoryMode('weight')">Poids</button>
            </div>

            <div id="history-subview-list">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 id="histMainTitle" style="margin:0; font-size:1rem; text-transform:uppercase; color:#b2bec3;">Types</h3>
                    <button id="histActionBtn" class="btn-danger" style="padding:6px 12px; font-size:0.75rem;">Effacer</button>
                </div>
                <div id="listeHistorique"></div>
            </div>

            <div id="history-subview-calendar" class="hidden">
                <div class="calendar-wrapper">
                    <div class="calendar-header">
                        <div class="btn-cal-nav" onclick="changeMonth(-1)">&#10094;</div>
                        <div id="calMonthDisplay" style="font-weight:800; font-size:1.1rem;"></div>
                        <div class="btn-cal-nav" onclick="changeMonth(1)">&#10095;</div>
                    </div>
                    <div class="calendar-weekdays">
                        <div class="cal-weekday">Lun</div><div class="cal-weekday">Mar</div><div class="cal-weekday">Mer</div><div class="cal-weekday">Jeu</div><div class="cal-weekday">Ven</div><div class="cal-weekday">Sam</div><div class="cal-weekday">Dim</div>
                    </div>
                    <div id="calendarGrid" class="calendar-grid"></div>
                </div>
                <div id="daySessionsList"></div>
            </div>

            <div id="history-subview-weight" class="hidden">
                <div class="weight-input-area">
                    <input type="date" id="weightDateInput" class="date-input-styled">
                    <div class="input-wrapper">
                        <input type="number" id="weightValueInput" placeholder="Poids (kg)" step="0.1">
                    </div>
                    <button class="btn-add-weight" onclick="addWeightEntry()">+</button>
                </div>

                <div class="chart-container">
                    <canvas id="weightChart"></canvas>
                </div>

                <h3 style="font-size:0.9rem; text-transform:uppercase; color:#b2bec3; margin-bottom:10px; margin-top:20px;">Historique du poids</h3>
                <div id="weightHistoryList"></div>
            </div>
        </div>
    </div>

    <div class="nav-bar">
        <button class="nav-item active" onclick="switchTab('seance', this, 0)">Séance</button>
        <button class="nav-item" onclick="switchTab('progs', this, 1)">Programme</button>
        <button class="nav-item" onclick="switchTab('history', this, 2)">Historique</button>
    </div>

    <script src="app.js"></script>
</body>
</html>
